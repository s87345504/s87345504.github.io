<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>loading...</title>
    <script>
        const svgIcon = {
            404: `<svg t="1761804146449" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14076" width="100" height="100"><path d="M904.139 140.861H105.854c-27.586 0-42.015 28.188-42.015 56.02v644.243c0 27.08 14.922 42.015 42.015 42.015H904.14c27.833 0 56.02-14.442 56.02-42.015V196.88c0-27.224-28.79-56.02-56.02-56.02z m28.01 700.263c0 9.656-16.385 13.992-28.01 13.992H105.854c-11.775 0-14.005-2.23-14.005-13.992V324.068c0.944 0.205 1.82-1.135 2.818-1.135h837.482v518.19z m0-546.202H94.669c-1 0-1.874 2.072-2.818 2.27V196.882c0-11.619 4.35-28.003 14.005-28.003H904.14c11.776 0 28.01 16.234 28.01 28.003v98.041zM169.904 655.668c1.901 1.504 4.226 3.391 6.839 3.391h125.184v70.025h28.01V659.06h39.361c2.654 0 2.052-2.133 3.296-3.583 1.287-1.477-0.642-4.678-0.642-6.784V631.05h-42.015V448.97h-28.94L162.668 631.406l3.556 17.492c0.547 2.229 1.765 5.224 3.68 6.77z m134.265-166.672c-0.67 4.226-1.285 7.05-1.518 11.017-0.178 3.966-0.724 7.68-0.724 11.134V631.05H200.991l103.177-142.054z m106.623 209.711c9.246 11.914 20.133 20.762 32.66 26.617 12.501 5.839 26.041 8.698 40.607 8.698 14.402 0 27.955-2.86 40.592-8.698 12.598-5.855 23.594-14.703 32.852-26.617 9.26-11.898 16.563-26.957 21.897-45.146 5.36-18.218 8.042-39.745 8.042-64.636 0-24.858-2.682-46.44-8.042-64.705-5.335-18.258-12.638-33.357-21.897-45.345-9.258-11.967-20.254-20.898-32.852-26.705-12.638-5.805-26.19-8.746-40.592-8.746-14.565 0-28.106 2.941-40.607 8.746-12.527 5.807-23.414 14.737-32.66 26.705-9.258 11.988-16.534 27.087-21.828 45.345-5.333 18.266-7.932 39.847-7.932 64.705 0 24.89 2.599 46.418 7.932 64.636 5.294 18.19 12.57 33.248 21.828 45.146z m12.227-164.455c3.639-14.751 8.493-26.635 14.593-35.635 6.06-8.972 13.145-15.475 21.241-19.366 8.07-3.858 16.453-5.84 25.206-5.84 8.74 0 17.11 1.983 25.206 5.84 8.082 3.89 15.208 10.394 21.336 19.366 6.142 9 11.024 20.884 14.702 35.635 3.64 14.75 5.444 32.994 5.444 54.673 0 21.719-1.805 39.909-5.444 54.597-3.678 14.689-8.56 26.534-14.702 35.534-6.127 8.999-13.253 15.481-21.336 19.366-8.096 3.899-16.466 5.84-25.206 5.84-8.753 0-17.136-1.941-25.206-5.84-8.096-3.885-15.182-10.367-21.24-19.366-6.1-9-10.955-20.844-14.594-35.534-3.665-14.688-5.47-32.878-5.47-54.597 0-21.679 1.805-39.923 5.47-54.673z m175.666 121.416c1.914 1.504 4.197 3.391 6.837 3.391h130.56v70.025h28.009V659.06h34.001c2.638 0 4.745-2.133 5.99-3.583 1.246-1.477 2.026-4.678 2.026-6.784V631.05H764.09V448.97H729.79L591.408 631.404l3.57 17.493c0.56 2.23 1.762 5.225 3.706 6.771z m135.603-166.672c-0.656 4.226 0.015 7.05-0.164 11.017-0.22 3.966 1.957 7.68 1.957 11.134V631.05H629.728l104.56-142.054z m-583.19-272.42c-10.394 0-18.804 8.418-18.804 18.833 0 10.393 8.411 18.82 18.805 18.82 10.408 0 18.82-8.426 18.82-18.82-0.002-10.416-8.412-18.833-18.82-18.833z m75.25 0c-10.395 0-18.806 8.418-18.806 18.833 0 10.393 8.412 18.82 18.806 18.82 10.408 0 18.82-8.426 18.82-18.82 0-10.416-8.412-18.833-18.82-18.833z m75.25 0c-10.395 0-18.806 8.418-18.806 18.833 0 10.393 8.412 18.82 18.805 18.82s18.82-8.426 18.82-18.82c0-10.416-8.425-18.833-18.82-18.833z" fill="#1D3658" p-id="14077"></path></svg>`,
            redirect: `<svg t="1761719914649" class="icon" viewBox="0 0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="8062" width="100" height="100">
                    <path
                        d="M905.69 75.46l0.16-0.33H118.31C92.77 75.22 72.09 95.9 72 121.44v162.6h880V121.93c0-25.6-20.71-46.38-46.31-46.47zM292.01 214.39H199.5c-19.19 0-34.75-15.56-34.75-34.75s15.56-34.75 34.75-34.75h92.51c19.19 0 34.75 15.56 34.75 34.75s-15.56 34.75-34.75 34.75z m532.76 0H454.13c-19.19 0-34.75-15.56-34.75-34.75s15.56-34.75 34.75-34.75h370.64c19.19 0 34.75 15.56 34.75 34.75s-15.56 34.75-34.75 34.75zM72 346.78v555.78c0.09 25.54 20.77 46.22 46.31 46.31h787.38c25.54-0.09 46.22-20.77 46.31-46.31V346.78H72z m644.75 424.81l-43.31 41.43a13.714 13.714 0 0 1-9.45 3.76 13.4 13.4 0 0 1-5.11-1.03 12.79 12.79 0 0 1-8.29-11.83v-15.85h-90.25c-9.16 0.03-17.72-4.57-22.75-12.23l-1.62-3-23.92-51.46-0.14-0.27-23.92 51.46-1.62 3c-5 7.69-13.58 12.3-22.75 12.23h-90.29v15.85c-0.04 5.28-3.34 9.98-8.29 11.83-1.62 0.65-3.36 0.99-5.11 0.99-3.5 0.02-6.88-1.33-9.4-3.76l-43.31-41.38a12.69 12.69 0 0 1-3.89-8.96c0.06-3.38 1.45-6.59 3.85-8.96l43.35-41.34c2.52-2.43 5.89-3.79 9.4-3.76 1.75 0 3.49 0.34 5.11 0.98 4.95 1.84 8.25 6.55 8.29 11.83v15.9h72.92l36.5-78.24-46.67-100.33h-62.71v15.85c-0.04 5.28-3.34 9.98-8.29 11.83-1.63 0.65-3.39 0.98-5.15 0.98-3.49 0-6.85-1.34-9.36-3.76l-43.31-41.38a12.591 12.591 0 0 1-3.89-8.96c0.04-3.38 1.43-6.61 3.86-8.96l43.35-41.38c2.55-2.42 5.93-3.76 9.45-3.76 1.73 0 3.45 0.31 5.06 0.94a12.74 12.74 0 0 1 8.29 11.83v15.85h80.08c9.2-0.08 17.8 4.55 22.79 12.27l1.62 2.95 34.08 73.41 34.08-73.41 1.65-2.95a26.86 26.86 0 0 1 22.75-12.27h80.08v-15.85c0.08-5.27 3.36-9.95 8.29-11.83 1.62-0.65 3.36-0.99 5.11-0.99 3.51-0.01 6.89 1.32 9.45 3.72l43.31 41.38a12.69 12.69 0 0 1 3.89 8.96c-0.03 3.39-1.44 6.62-3.89 8.96l-43.31 41.38a13.714 13.714 0 0 1-9.45 3.76c-1.74 0-3.46-0.34-5.06-0.98a12.79 12.79 0 0 1-8.29-11.83V558.4h-62.71l-46.62 100.37 36.46 78.47h72.87v-15.9c0.08-5.26 3.37-9.93 8.29-11.78 1.62-0.65 3.36-0.99 5.11-0.99 3.51-0.01 6.89 1.32 9.45 3.72l43.31 41.38a12.69 12.69 0 0 1 3.89 8.96c-0.03 3.39-1.44 6.62-3.89 8.96z"
                        p-id="8063" fill="#1D3658"></path>
                </svg>
            </i>`

        }
    </script>
</head>

<body style="margin: 0;">
    <main
        style="width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; user-select: none;overflow:hidden;">
        <section
            style="width: 100%; height: 200px; display: flex; flex-direction: column; gap: 10px; justify-content: center; align-items: center; position: relative; color: #1d3658;">
            <i id="icon-container" style="width: 100px; height: 100px;">
                <svg t="1761804392138" class="icon" viewBox="0 0 1025 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="15207" width="100" height="100">
                    <path
                        d="M982.668821 313.74918c-25.810101-60.752236-62.714-115.373446-109.685763-162.346233-46.972787-46.971763-101.593997-83.875662-162.346233-109.685763C647.666853 14.966132 580.925912 1.401699 512.268258 1.401699S376.868639 14.966132 313.898667 41.717184c-60.752236 25.810101-115.373446 62.714-162.346233 109.685763-46.971763 46.972787-83.875662 101.593997-109.685763 162.346233C15.115619 376.719151 1.551186 443.460092 1.551186 512.118771S15.115619 647.517366 41.866671 710.487337c25.810101 60.75326 62.714 115.37447 109.685763 162.346233 46.971763 46.972787 101.592974 83.876686 162.346233 109.685763 62.969971 26.752076 129.710912 40.316509 198.369591 40.316509s135.398595-13.564433 198.368567-40.316509c60.75326-25.809077 115.37447-62.712976 162.346233-109.685763 46.972787-46.971763 83.876686-101.592974 109.685763-162.346233 26.752076-62.969971 40.316509-129.710912 40.316509-198.368567S1009.419873 376.719151 982.668821 313.74918zM937.435615 691.271058c-23.333323 54.923257-56.71096 104.317532-99.204249 146.811845-42.494313 42.493289-91.888588 75.870926-146.811845 99.204249-56.8584 24.155503-117.133505 36.403219-179.152287 36.403219-62.018782 0-122.293887-12.247716-179.152287-36.403219-54.923257-23.333323-104.317532-56.71096-146.810821-99.204249-42.493289-42.494313-75.870926-91.888588-99.204249-146.811845C62.944374 634.412658 50.697682 574.136529 50.697682 512.118771c0-62.018782 12.247716-122.293887 36.403219-179.152287 23.333323-54.923257 56.709936-104.317532 99.204249-146.810821s91.888588-75.870926 146.810821-99.204249c56.8584-24.155503 117.133505-36.403219 179.152287-36.403219 62.017758 0 122.292863 12.247716 179.152287 36.403219 54.923257 23.333323 104.317532 56.709936 146.810821 99.204249 42.494313 42.493289 75.870926 91.888588 99.205273 146.810821 24.155503 56.8584 36.403219 117.134529 36.403219 179.152287S961.591118 634.412658 937.435615 691.271058z"
                        fill="#1D3658" p-id="15208"></path>
                    <path
                        d="M704.62457 319.769626c-9.997216-9.996192-26.203273-9.996192-36.199466 0L512.382933 475.810773 356.341786 319.769626c-9.996192-9.996192-26.204297-9.996192-36.199466 0-9.996192 9.996192-9.996192 26.203273 0 36.199466l156.041147 156.041147L320.14232 668.05241c-9.996192 9.997216-9.996192 26.204297 0 36.199466 4.997584 4.998608 11.549426 7.496888 18.100245 7.496888s13.101637-2.49828 18.100245-7.496888l156.041147-156.041147L668.424081 704.251876c4.998608 4.998608 11.548403 7.496888 18.100245 7.496888s13.101637-2.49828 18.100245-7.496888c9.996192-9.996192 9.996192-26.203273 0-36.199466L548.583423 512.011263l156.041147-156.041147C714.620762 345.973923 714.620762 329.765818 704.62457 319.769626z"
                        fill="#1D3658" p-id="15209"></path>
                </svg>
            </i>
            <span id="tip">loading...</span>

            <button id="redirectButton"
                style="display: none;width: 100px; height: 30px;line-height:30px;padding:0; border-radius: 5px; border: none; background-color: #1d3658; color: #fff; font-size: 14px; cursor: pointer; border: 1px solid #1d3658; transition: all .3s;"
                onmouseover="this.style.backgroundColor='#fff'; this.style.color='#1d3658'"
                onmouseout="this.style.backgroundColor='#1d3658'; this.style.color='#fff'">跳转</button>
        </section>
    </main>
    <script>
        const REDIRECTED_KEY = "redirected";
        const EXPECTED_HASH = "6cbf40494f64db7248d7d4d7737f772d6f80941cb93389b49d4321487328acb8";
        const REDIRECT_URL = "/foodQuery";

        const redirectButton = document.querySelector("#redirectButton");
        const tipElement = document.querySelector("#tip");
        const svgContainer = document.querySelector("#icon-container");

        const currentUrl = new URL(`${location.origin}${location.hash.substr(1)}`);
        const urlParams = Object.fromEntries(currentUrl.searchParams);

        async function initialize() {
            try {
                if (urlParams.ref) {
                    const hash = await sha256(urlParams.ref);
                    hash === EXPECTED_HASH ? handleRedirect() : showNotFound();
                } else {
                    showNotFound();
                }
            } catch (error) {
                console.error("Initialization error:", error);
                showNotFound();
            }
        }

        function redirectUser() {
            localStorage.setItem(REDIRECTED_KEY, "true");
            window.location.href = REDIRECT_URL;
        }

        function showNotFound() {
            document.title = "Not Found";
            svgContainer.innerHTML = svgIcon["404"];
            tipElement.textContent = "找不到页面，请检查地址是否正确";
            redirectButton.style.display = "none";
        }

        function handleRedirect() {
            document.title = "Redirecting";
            svgContainer.innerHTML = svgIcon.redirect;
            redirectButton.style.display = "block";

            if (localStorage.getItem(REDIRECTED_KEY) === "true") {
                tipElement.textContent = `地址已永久变更，请点击下方按钮跳转`;
                redirectUser();
            } else {
                startCountdown();
            }
        }

        function startCountdown() {
            let secondsRemaining = 3;
            tipElement.textContent = `地址已永久变更，将在 ${secondsRemaining} 秒后自动跳转`;

            const countdownInterval = setInterval(() => {
                secondsRemaining--;

                if (secondsRemaining <= 0) {
                    clearInterval(countdownInterval);
                    redirectUser();
                } else {
                    tipElement.textContent = `地址已永久变更，将在 ${secondsRemaining} 秒后自动跳转`;
                }
            }, 1000);

            redirectButton.addEventListener("click", () => {
                clearInterval(countdownInterval);
                redirectUser();
            }, { once: true });
        }

        async function sha256(message) {
            try {
                const encoder = new TextEncoder();
                const data = encoder.encode(message);
                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            } catch (error) {
                console.error("Hashing error:", error);
                throw error;
            }
        }

        // Start the application
        initialize();

    </script>
</body>

</html>